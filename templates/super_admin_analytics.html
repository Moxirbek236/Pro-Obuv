{% extends "base.html" %}

{% block title %}Analytics - Super Admin{% endblock %}

{% block content %}
<div class="analytics-container">
    <div class="analytics-header">
        <h1>üìä Advanced Analytics Dashboard</h1>
        <div class="breadcrumb">
            <a href="{{ url_for('super_admin_dashboard') }}">Dashboard</a> / Analytics
        </div>
    </div>

    <!-- KPI Cards -->
    <div class="kpi-grid">
        <div class="kpi-card revenue">
            <div class="kpi-icon">üí∞</div>
            <div class="kpi-content">
                <h3>Bugungi Daromad</h3>
                <div class="kpi-value" id="today-revenue">0 so'm</div>
                <div class="kpi-change positive" id="revenue-change">+12.5%</div>
            </div>
        </div>

        <div class="kpi-card orders">
            <div class="kpi-icon">üì¶</div>
            <div class="kpi-content">
                <h3>Bugungi Buyurtmalar</h3>
                <div class="kpi-value" id="today-orders">0</div>
                <div class="kpi-change positive" id="orders-change">+8.3%</div>
            </div>
        </div>

        <div class="kpi-card users">
            <div class="kpi-icon">üë•</div>
            <div class="kpi-content">
                <h3>Faol Foydalanuvchilar</h3>
                <div class="kpi-value" id="active-users">0</div>
                <div class="kpi-change neutral" id="users-change">+2.1%</div>
            </div>
        </div>

        <div class="kpi-card rating">
            <div class="kpi-icon">‚≠ê</div>
            <div class="kpi-content">
                <h3>O'rtacha Baho</h3>
                <div class="kpi-value" id="avg-rating">4.5</div>
                <div class="kpi-change positive" id="rating-change">+0.2</div>
            </div>
        </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-grid">
        <div class="chart-container">
            <h3>üìà Daromad Trendi</h3>
            <div class="chart-placeholder">
                <p>Chart.js yuklanganda grafiklar ko'rsatiladi</p>
            </div>
        </div>

        <div class="chart-container">
            <h3>üìä Buyurtmalar Statistikasi</h3>
            <div class="chart-placeholder">
                <p>Buyurtmalar statistikasi</p>
            </div>
        </div>
    </div>

    <div class="back-button">
        <a href="{{ url_for('super_admin_dashboard') }}" class="btn btn-primary">‚¨ÖÔ∏è Dashboard ga qaytish</a>
    </div>
</div>

<style>
.analytics-container {
    padding: 20px;
    max-width: 1400px;
    margin: 0 auto;
}

.analytics-header {
    margin-bottom: 30px;
}

.analytics-header h1 {
    color: #2d3748;
    margin-bottom: 10px;
}

.breadcrumb {
    color: #718096;
    font-size: 14px;
}

.breadcrumb a {
    color: #3182ce;
    text-decoration: none;
}

.kpi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.kpi-card {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    display: flex;
    align-items: center;
    gap: 20px;
    transition: transform 0.2s ease;
}

.kpi-card:hover {
    transform: translateY(-2px);
}

.kpi-card.revenue { border-left: 4px solid #28a745; }
.kpi-card.orders { border-left: 4px solid #007bff; }
.kpi-card.users { border-left: 4px solid #6f42c1; }
.kpi-card.rating { border-left: 4px solid #ffc107; }

.kpi-icon {
    font-size: 3rem;
    opacity: 0.8;
}

.kpi-content h3 {
    font-size: 1rem;
    color: #718096;
    margin-bottom: 8px;
}

.kpi-value {
    font-size: 2rem;
    font-weight: bold;
    color: #2d3748;
    margin-bottom: 5px;
}

.kpi-change {
    font-size: 0.9rem;
    font-weight: 500;
}

.kpi-change.positive { color: #28a745; }
.kpi-change.negative { color: #dc3545; }
.kpi-change.neutral { color: #6c757d; }

.charts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
}

.chart-container {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.chart-container h3 {
    margin-bottom: 20px;
    color: #2d3748;
    font-size: 1.2rem;
}

.chart-placeholder {
    height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f9fa;
    border-radius: 8px;
    color: #6c757d;
}

.back-button {
    text-align: center;
    margin-top: 30px;
}

.btn {
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    text-decoration: none;
    display: inline-block;
    font-weight: 500;
}

.btn-primary {
    background-color: #007bff;
    color: white;
}

.btn-primary:hover {
    background-color: #0056b3;
}

/* Mobile responsive */
@media (max-width: 768px) {
    .analytics-container {
        padding: 15px;
    }

    .kpi-grid {
        grid-template-columns: 1fr;
    }

    .charts-grid {
        grid-template-columns: 1fr;
    }

    .kpi-card {
        padding: 20px;
    }

    .kpi-icon {
        font-size: 2.5rem;
    }

    .kpi-value {
        font-size: 1.5rem;
    }
}
</style>

<script>
// Mock analytics ma'lumotlari
document.addEventListener('DOMContentLoaded', function() {
    // Mock KPI ma'lumotlari
    document.getElementById('today-revenue').textContent = '2,500,000 so\'m';
    document.getElementById('today-orders').textContent = '45';
    document.getElementById('active-users').textContent = '23';
    document.getElementById('avg-rating').textContent = '4.7';
});
</script>
{% endblock %}
{% extends "base.html" %}

{% block title %}Analytics - Super Admin Panel{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>üìä Analytics Dashboard</h2>
                <a href="{{ url_for('super_admin_dashboard') }}" class="btn btn-outline-primary">
                    ‚Üê Dashboard ga qaytish
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Oylik statistika -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">üìà Oylik buyurtmalar statistikasi</h5>
                </div>
                <div class="card-body">
                    {% if analytics.monthly_orders %}
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Oy</th>
                                        <th>Buyurtmalar</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in analytics.monthly_orders %}
                                    <tr>
                                        <td>{{ item.month }}</td>
                                        <td><span class="badge bg-primary">{{ item.orders }}</span></td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <p class="text-muted">Ma'lumotlar mavjud emas</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Mashhur mahsulotlar -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">üèÜ Eng mashhur mahsulotlar</h5>
                </div>
                <div class="card-body">
                    {% if analytics.popular_items %}
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Mahsulot</th>
                                        <th>Sotilgan</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in analytics.popular_items %}
                                    <tr>
                                        <td>{{ item.name }}</td>
                                        <td><span class="badge bg-success">{{ item.sold }}</span></td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <p class="text-muted">Ma'lumotlar mavjud emas</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Qo'shimcha statistikalar -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">üìä Umumiy ko'rsatkichlar</h5>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-md-3">
                            <div class="border p-3 rounded">
                                <h4 class="text-primary">{{ analytics.total_revenue or 0 }}</h4>
                                <small class="text-muted">Umumiy daromad</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="border p-3 rounded">
                                <h4 class="text-success">{{ analytics.growth_rate or 0 }}%</h4>
                                <small class="text-muted">O'sish sur'ati</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="border p-3 rounded">
                                <h4 class="text-info">{{ analytics.monthly_orders|length or 0 }}</h4>
                                <small class="text-muted">Faol oylar</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="border p-3 rounded">
                                <h4 class="text-warning">{{ analytics.popular_items|length or 0 }}</h4>
                                <small class="text-muted">TOP mahsulotlar</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
