
{% extends "base.html" %}

{% block title %}Loglar - Super Admin{% endblock %}

{% block content %}
<div class="logs-container">
    <div class="logs-header">
        <h1>üìù Tizim Loglari</h1>
        <div class="breadcrumb">
            <a href="{{ url_for('super_admin_dashboard') }}">Dashboard</a> / Loglar
        </div>
    </div>

    <!-- Log Filters -->
    <div class="filters-section">
        <div class="filter-group">
            <label>Log darajasi:</label>
            <select id="logLevel" onchange="filterLogs()">
                <option value="all">Barchasi</option>
                <option value="ERROR">ERROR</option>
                <option value="WARNING">WARNING</option>
                <option value="INFO">INFO</option>
                <option value="DEBUG">DEBUG</option>
            </select>
        </div>
        
        <div class="filter-group">
            <label>Sana:</label>
            <input type="date" id="logDate" onchange="filterLogs()">
        </div>
        
        <div class="filter-group">
            <button class="btn btn-primary" onclick="refreshLogs()">üîÑ Yangilash</button>
            <button class="btn btn-success" onclick="downloadLogs()">üìÑ Yuklab olish</button>
        </div>
    </div>

    <!-- Real-time Logs -->
    <div class="logs-section">
        <div class="logs-header-controls">
            <h3>üìä Real-time Logs</h3>
            <div class="log-controls">
                <button class="btn btn-sm btn-success" onclick="startAutoRefresh()">‚ñ∂Ô∏è Auto Refresh</button>
                <button class="btn btn-sm btn-warning" onclick="stopAutoRefresh()">‚è∏Ô∏è Stop</button>
                <button class="btn btn-sm btn-danger" onclick="clearLogDisplay()">üóëÔ∏è Clear Display</button>
            </div>
        </div>
        
        <div class="logs-display" id="logsDisplay">
            <div class="log-entry info">
                <span class="log-time">{{ moment().format('YYYY-MM-DD HH:mm:ss') }}</span>
                <span class="log-level">INFO</span>
                <span class="log-message">Loglar yuklanyapti...</span>
            </div>
        </div>
    </div>

    <!-- System Performance -->
    <div class="performance-section">
        <h3>üìà Tizim Performance</h3>
        <div class="performance-grid">
            <div class="perf-card">
                <h4>üöÄ Response Time</h4>
                <div class="perf-value" id="responseTime">0ms</div>
                <div class="perf-subtitle">O'rtacha javob vaqti</div>
            </div>
            
            <div class="perf-card">
                <h4>üíæ Memory Usage</h4>
                <div class="perf-value" id="memoryUsage">0%</div>
                <div class="perf-subtitle">Xotira foydalanishi</div>
            </div>
            
            <div class="perf-card">
                <h4>üî¢ Active Sessions</h4>
                <div class="perf-value" id="activeSessions">0</div>
                <div class="perf-subtitle">Faol sessiyalar</div>
            </div>
            
            <div class="perf-card">
                <h4>‚ö†Ô∏è Error Rate</h4>
                <div class="perf-value" id="errorRate">0%</div>
                <div class="perf-subtitle">Xatoliklar darajasi</div>
            </div>
        </div>
    </div>

    <!-- Error Summary -->
    <div class="errors-section">
        <h3>üö® Oxirgi Xatoliklar</h3>
        <div id="errorsSummary" class="errors-list">
            <p class="text-center">Xatoliklar yuklanmoqda...</p>
        </div>
    </div>
</div>

<script>
let autoRefreshInterval = null;

// Loglarni yuklash
function loadLogs() {
    const logLevel = document.getElementById('logLevel').value;
    const logDate = document.getElementById('logDate').value;
    
    // Mock data - haqiqiy implementatsiyada backend API dan ma'lumot olish kerak
    const mockLogs = [
        {
            time: '2025-01-23 15:30:45',
            level: 'INFO',
            message: 'Yangi foydalanuvchi ro\'yxatdan o\'tdi: test@example.com',
            source: 'auth.py:142'
        },
        {
            time: '2025-01-23 15:30:40',
            level: 'ERROR',
            message: 'Database connection timeout',
            source: 'database.py:67'
        },
        {
            time: '2025-01-23 15:30:35',
            level: 'WARNING',
            message: 'Rate limit exceeded for IP: 192.168.1.100',
            source: 'middleware.py:23'
        },
        {
            time: '2025-01-23 15:30:30',
            level: 'INFO',
            message: 'Buyurtma yaratildi: #10125',
            source: 'orders.py:89'
        }
    ];
    
    displayLogs(mockLogs);
}

// Loglarni ko'rsatish
function displayLogs(logs) {
    const container = document.getElementById('logsDisplay');
    container.innerHTML = '';
    
    logs.forEach(log => {
        const logEntry = document.createElement('div');
        logEntry.className = `log-entry ${log.level.toLowerCase()}`;
        logEntry.innerHTML = `
            <span class="log-time">${log.time}</span>
            <span class="log-level">${log.level}</span>
            <span class="log-source">${log.source}</span>
            <span class="log-message">${log.message}</span>
        `;
        container.appendChild(logEntry);
    });
}

// Loglarni filtrlash
function filterLogs() {
    loadLogs();
}

// Loglarni yangilash
function refreshLogs() {
    loadLogs();
    loadPerformanceStats();
    loadErrorsSummary();
}

// Auto refresh ni boshlash
function startAutoRefresh() {
    if (autoRefreshInterval) return;
    
    autoRefreshInterval = setInterval(() => {
        loadLogs();
        loadPerformanceStats();
    }, 5000); // 5 soniyada bir
    
    showSuccessMessage('Auto refresh yoqildi');
}

// Auto refresh ni to'xtatish
function stopAutoRefresh() {
    if (autoRefreshInterval) {
        clearInterval(autoRefreshInterval);
        autoRefreshInterval = null;
        showSuccessMessage('Auto refresh o\'chirildi');
    }
}

// Log displayni tozalash
function clearLogDisplay() {
    document.getElementById('logsDisplay').innerHTML = '';
    showSuccessMessage('Log display tozalandi');
}

// Performance statistikalarini yuklash
function loadPerformanceStats() {
    // Mock data
    document.getElementById('responseTime').textContent = Math.floor(Math.random() * 500 + 200) + 'ms';
    document.getElementById('memoryUsage').textContent = Math.floor(Math.random() * 40 + 40) + '%';
    document.getElementById('activeSessions').textContent = Math.floor(Math.random() * 50 + 10);
    document.getElementById('errorRate').textContent = (Math.random() * 5).toFixed(1) + '%';
}

// Xatoliklar xulosasini yuklash
function loadErrorsSummary() {
    const container = document.getElementById('errorsSummary');
    
    // Mock errors
    const mockErrors = [
        { time: '15:30:40', message: 'Database connection timeout', count: 3 },
        { time: '15:25:12', message: 'Invalid JSON in request body', count: 1 },
        { time: '15:20:33', message: 'User authentication failed', count: 7 }
    ];
    
    let html = '';
    mockErrors.forEach(error => {
        html += `
            <div class="error-item">
                <span class="error-time">${error.time}</span>
                <span class="error-message">${error.message}</span>
                <span class="error-count">${error.count}x</span>
            </div>
        `;
    });
    
    container.innerHTML = html;
}

// Loglarni yuklab olish
function downloadLogs() {
    const logLevel = document.getElementById('logLevel').value;
    const logDate = document.getElementById('logDate').value;
    
    // Bu yerda haqiqiy API orqali log faylini yuklab olish
    showSuccessMessage('Loglar yuklab olinmoqda...');
}

// Success message
function showSuccessMessage(message) {
    const notification = document.createElement('div');
    notification.className = 'notification success';
    notification.textContent = message;
    document.body.appendChild(notification);

    setTimeout(() => notification.classList.add('show'), 100);
    setTimeout(() => notification.remove(), 3000);
}

// Sahifa yuklanganda
document.addEventListener('DOMContentLoaded', function() {
    // Bugungi sanani o'rnatish
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('logDate').value = today;
    
    // Dastlabki ma'lumotlarni yuklash
    loadLogs();
    loadPerformanceStats();
    loadErrorsSummary();
});
</script>

<style>
.logs-container {
    padding: 20px;
    max-width: 1600px;
    margin: 0 auto;
}

.logs-header {
    margin-bottom: 30px;
}

.logs-header h1 {
    color: #2d3748;
    margin-bottom: 10px;
}

.breadcrumb {
    color: #718096;
    font-size: 14px;
}

.breadcrumb a {
    color: #3182ce;
    text-decoration: none;
}

.filters-section {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    margin-bottom: 30px;
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    align-items: end;
}

.filter-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.filter-group label {
    font-weight: 500;
    color: #2d3748;
    font-size: 14px;
}

.filter-group select,
.filter-group input {
    padding: 10px 12px;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    font-size: 14px;
    min-width: 150px;
}

.logs-section {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    margin-bottom: 30px;
}

.logs-header-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.log-controls {
    display: flex;
    gap: 10px;
}

.logs-display {
    background: #1a1a1a;
    color: #ffffff;
    border-radius: 8px;
    padding: 20px;
    max-height: 400px;
    overflow-y: auto;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    line-height: 1.5;
}

.log-entry {
    display: flex;
    margin-bottom: 8px;
    padding: 4px 0;
    border-bottom: 1px solid #333;
}

.log-entry:last-child {
    border-bottom: none;
}

.log-time {
    color: #888;
    margin-right: 15px;
    min-width: 130px;
}

.log-level {
    font-weight: bold;
    margin-right: 15px;
    min-width: 60px;
}

.log-source {
    color: #6c757d;
    margin-right: 15px;
    min-width: 120px;
    font-size: 11px;
}

.log-message {
    flex: 1;
}

.log-entry.error .log-level { color: #ff4757; }
.log-entry.warning .log-level { color: #ffa502; }
.log-entry.info .log-level { color: #3742fa; }
.log-entry.debug .log-level { color: #2ed573; }

.performance-section {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    margin-bottom: 30px;
}

.performance-section h3 {
    margin-bottom: 20px;
    color: #2d3748;
}

.performance-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.perf-card {
    text-align: center;
    padding: 20px;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
}

.perf-card h4 {
    margin-bottom: 15px;
    color: #2d3748;
    font-size: 1rem;
}

.perf-value {
    font-size: 2rem;
    font-weight: bold;
    color: #007bff;
    margin-bottom: 8px;
}

.perf-subtitle {
    color: #6c757d;
    font-size: 0.9rem;
}

.errors-section {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.errors-section h3 {
    margin-bottom: 20px;
    color: #2d3748;
}

.errors-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.error-item {
    display: flex;
    align-items: center;
    padding: 12px;
    background: #fff5f5;
    border-left: 4px solid #e53e3e;
    border-radius: 6px;
}

.error-time {
    color: #666;
    margin-right: 15px;
    min-width: 80px;
    font-size: 0.9rem;
}

.error-message {
    flex: 1;
    color: #2d3748;
}

.error-count {
    background: #e53e3e;
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: bold;
}

.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    text-decoration: none;
    display: inline-block;
    transition: all 0.3s ease;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 12px;
}

.btn-primary { background: #007bff; color: white; }
.btn-success { background: #28a745; color: white; }
.btn-warning { background: #ffc107; color: #212529; }
.btn-danger { background: #dc3545; color: white; }

.btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 20px;
    border-radius: 8px;
    color: white;
    font-weight: 500;
    z-index: 10000;
    opacity: 0;
    transform: translateX(100%);
    transition: all 0.3s ease;
}

.notification.show {
    opacity: 1;
    transform: translateX(0);
}

.notification.success {
    background-color: #28a745;
}

.text-center { text-align: center; }

/* Mobile responsive */
@media (max-width: 768px) {
    .logs-container {
        padding: 15px;
    }
    
    .filters-section {
        flex-direction: column;
        align-items: stretch;
    }
    
    .filter-group {
        width: 100%;
    }
    
    .logs-header-controls {
        flex-direction: column;
        gap: 15px;
        align-items: stretch;
    }
    
    .log-controls {
        justify-content: center;
    }
    
    .performance-grid {
        grid-template-columns: 1fr;
    }
    
    .log-entry {
        flex-direction: column;
        gap: 5px;
    }
    
    .log-time,
    .log-level,
    .log-source {
        min-width: auto;
    }
}
</style>
{% endblock %}
{% extends "base.html" %}

{% block title %}Loglar - Super Admin{% endblock %}

{% block content %}
<div class="logs-container">
    <div class="page-header">
        <h1>üìù Tizim Loglari</h1>
        <nav class="breadcrumb">
            <a href="{{ url_for('super_admin_dashboard') }}">Dashboard</a> / Loglar
        </nav>
    </div>

    <!-- Log kategoriyalari -->
    <div class="log-categories">
        <div class="log-category-tabs">
            <button class="log-tab active" onclick="showLogCategory('recent')">üìÑ So'nggi Loglar</button>
            <button class="log-tab" onclick="showLogCategory('errors')">‚ö†Ô∏è Xatoliklar</button>
            <button class="log-tab" onclick="showLogCategory('system')">‚öôÔ∏è Tizim Loglari</button>
            <button class="log-tab" onclick="showLogCategory('live')">üî¥ Real-time</button>
        </div>
    </div>

    <!-- So'nggi loglar -->
    <div id="recent" class="log-content active">
        <div class="log-header">
            <h3>üìÑ So'nggi Loglar</h3>
            <button class="btn btn-secondary" onclick="refreshLogs('recent')">üîÑ Yangilash</button>
        </div>
        <div class="log-viewer">
            {% if logs.recent_logs %}
                {% for log in logs.recent_logs %}
                <div class="log-entry">{{ log }}</div>
                {% endfor %}
            {% else %}
                <p class="no-logs">Hozircha loglar yo'q</p>
            {% endif %}
        </div>
    </div>

    <!-- Xatoliklar -->
    <div id="errors" class="log-content">
        <div class="log-header">
            <h3>‚ö†Ô∏è Xatoliklar Loglari</h3>
            <button class="btn btn-danger" onclick="clearErrorLogs()">üóëÔ∏è Xatoliklarni Tozalash</button>
        </div>
        <div class="log-viewer error-logs">
            {% if logs.error_logs %}
                {% for error in logs.error_logs %}
                <div class="log-entry error">{{ error }}</div>
                {% endfor %}
            {% else %}
                <p class="no-logs">Hozircha xatoliklar yo'q</p>
            {% endif %}
        </div>
    </div>

    <!-- Tizim loglari -->
    <div id="system" class="log-content">
        <div class="log-header">
            <h3>‚öôÔ∏è Tizim Loglari</h3>
            <button class="btn btn-warning" onclick="downloadLogs()">üì• Yuklab Olish</button>
        </div>
        <div class="log-viewer">
            {% if logs.system_logs %}
                {% for log in logs.system_logs %}
                <div class="log-entry system">{{ log }}</div>
                {% endfor %}
            {% else %}
                <p class="no-logs">Tizim loglari hozircha yo'q</p>
            {% endif %}
        </div>
    </div>

    <!-- Real-time loglar -->
    <div id="live" class="log-content">
        <div class="log-header">
            <h3>üî¥ Real-time Loglar</h3>
            <button class="btn btn-success" id="liveToggle" onclick="toggleLiveMode()">‚ñ∂Ô∏è Boshlash</button>
        </div>
        <div class="log-viewer live-logs" id="liveLogs">
            <p class="no-logs">Real-time monitoring boshlash uchun "Boshlash" tugmasini bosing</p>
        </div>
    </div>

    <!-- Log statistikalari -->
    <div class="log-stats">
        <h3>üìä Log Statistikalari</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <h4>üìÑ Jami Loglar</h4>
                <div class="stat-value">{{ (logs.recent_logs|length) + (logs.error_logs|length) + (logs.system_logs|length) }}</div>
            </div>
            <div class="stat-card">
                <h4>‚ö†Ô∏è Xatoliklar</h4>
                <div class="stat-value">{{ logs.error_logs|length }}</div>
            </div>
            <div class="stat-card">
                <h4>üìà Bugungi Faollik</h4>
                <div class="stat-value">85%</div>
            </div>
        </div>
    </div>

    <div class="back-button">
        <a href="{{ url_for('super_admin_dashboard') }}" class="btn btn-primary">‚¨ÖÔ∏è Dashboard ga qaytish</a>
    </div>
</div>

<script>
let isLiveMode = false;
let liveInterval = null;

function showLogCategory(category) {
    // Barcha log contentlarni yashirish
    const contents = document.querySelectorAll('.log-content');
    contents.forEach(content => content.classList.remove('active'));
    
    // Barcha tablardan active ni olib tashlash
    const tabs = document.querySelectorAll('.log-tab');
    tabs.forEach(tab => tab.classList.remove('active'));
    
    // Kerakli category va tabni faollashtirish
    document.getElementById(category).classList.add('active');
    event.target.classList.add('active');
}

function refreshLogs(category) {
    showSuccessMessage(`${category} loglari yangilanmoqda...`);
    setTimeout(() => {
        location.reload();
    }, 1000);
}

function clearErrorLogs() {
    if (confirm('Barcha xatoliklar loglarini tozalamoqchimisiz?')) {
        showSuccessMessage('Xatoliklar loglari tozalandi');
        // Implementation keyin qo'shiladi
    }
}

function downloadLogs() {
    showSuccessMessage('Loglar yuklab olinmoqda...');
    // Implementation keyin qo'shiladi
}

function toggleLiveMode() {
    const button = document.getElementById('liveToggle');
    const logsDiv = document.getElementById('liveLogs');
    
    if (!isLiveMode) {
        // Live mode ni boshlash
        isLiveMode = true;
        button.textContent = '‚èπÔ∏è To\'xtatish';
        button.className = 'btn btn-danger';
        
        logsDiv.innerHTML = '<div class="log-entry live">üî¥ Real-time monitoring boshlandi...</div>';
        
        // Mock real-time logs
        liveInterval = setInterval(() => {
            const timestamp = new Date().toLocaleString();
            const mockLogs = [
                'User login attempt from IP: 192.168.1.100',
                'Order #12345 created successfully',
                'Database connection pool status: healthy',
                'Cache hit rate: 87%',
                'Memory usage: 65%'
            ];
            
            const randomLog = mockLogs[Math.floor(Math.random() * mockLogs.length)];
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry live';
            logEntry.textContent = `${timestamp} - ${randomLog}`;
            
            logsDiv.insertBefore(logEntry, logsDiv.firstChild);
            
            // Maksimal 50 ta log saqlash
            const entries = logsDiv.querySelectorAll('.log-entry');
            if (entries.length > 50) {
                entries[entries.length - 1].remove();
            }
        }, 2000);
        
    } else {
        // Live mode ni to'xtatish
        isLiveMode = false;
        button.textContent = '‚ñ∂Ô∏è Boshlash';
        button.className = 'btn btn-success';
        
        if (liveInterval) {
            clearInterval(liveInterval);
            liveInterval = null;
        }
        
        const stopEntry = document.createElement('div');
        stopEntry.className = 'log-entry system';
        stopEntry.textContent = `${new Date().toLocaleString()} - Real-time monitoring to'xtatildi`;
        logsDiv.insertBefore(stopEntry, logsDiv.firstChild);
    }
}

function showSuccessMessage(message) {
    const notification = document.createElement('div');
    notification.className = 'notification success';
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.classList.add('show');
    }, 100);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// Sahifadan chiqishda live mode ni to'xtatish
window.addEventListener('beforeunload', function() {
    if (liveInterval) {
        clearInterval(liveInterval);
    }
});
</script>

<style>
.logs-container {
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
}

.page-header {
    margin-bottom: 30px;
}

.page-header h1 {
    color: #2d3748;
    margin-bottom: 10px;
}

.breadcrumb {
    color: #718096;
    font-size: 14px;
}

.breadcrumb a {
    color: #3182ce;
    text-decoration: none;
}

.log-categories {
    margin-bottom: 20px;
}

.log-category-tabs {
    display: flex;
    background: white;
    border-radius: 10px;
    padding: 5px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    overflow-x: auto;
}

.log-tab {
    flex: 1;
    background: none;
    border: none;
    padding: 12px 20px;
    cursor: pointer;
    border-radius: 6px;
    font-weight: 500;
    white-space: nowrap;
    transition: all 0.2s ease;
}

.log-tab.active,
.log-tab:hover {
    background: #007bff;
    color: white;
}

.log-content {
    display: none;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.log-content.active {
    display: block;
}

.log-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid #e2e8f0;
}

.log-header h3 {
    margin: 0;
    color: #2d3748;
}

.log-viewer {
    padding: 20px;
    background: #1a202c;
    color: #e2e8f0;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    line-height: 1.4;
    max-height: 400px;
    overflow-y: auto;
    border-bottom-left-radius: 10px;
    border-bottom-right-radius: 10px;
}

.log-entry {
    margin-bottom: 8px;
    padding: 5px 8px;
    border-radius: 4px;
    background: rgba(255,255,255,0.05);
}

.log-entry.error {
    background: rgba(220,53,69,0.2);
    border-left: 3px solid #dc3545;
}

.log-entry.live {
    background: rgba(40,167,69,0.2);
    border-left: 3px solid #28a745;
}

.log-entry.system {
    background: rgba(23,162,184,0.2);
    border-left: 3px solid #17a2b8;
}

.error-logs .log-entry {
    background: rgba(220,53,69,0.1);
    color: #dc3545;
}

.no-logs {
    text-align: center;
    color: #9ca3af;
    font-style: italic;
    margin: 0;
}

.log-stats {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.stat-card {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
    border-left: 4px solid #007bff;
}

.stat-card h4 {
    margin-bottom: 10px;
    color: #495057;
    font-size: 14px;
}

.stat-value {
    font-size: 24px;
    font-weight: bold;
    color: #007bff;
}

.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
}

.btn-primary {
    background-color: #007bff;
    color: white;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
}

.btn-danger {
    background-color: #dc3545;
    color: white;
}

.btn-warning {
    background-color: #ffc107;
    color: #212529;
}

.btn-success {
    background-color: #28a745;
    color: white;
}

.back-button {
    text-align: center;
    margin-top: 30px;
}

.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 20px;
    border-radius: 8px;
    color: white;
    font-weight: 500;
    z-index: 10000;
    opacity: 0;
    transform: translateX(100%);
    transition: all 0.3s ease;
}

.notification.show {
    opacity: 1;
    transform: translateX(0);
}

.notification.success {
    background-color: #28a745;
}

.notification.error {
    background-color: #dc3545;
}

@media (max-width: 768px) {
    .logs-container {
        padding: 10px;
    }
    
    .log-category-tabs {
        flex-direction: column;
    }
    
    .log-header {
        flex-direction: column;
        gap: 10px;
    }
    
    .log-viewer {
        font-size: 11px;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
{% extends "base.html" %}

{% block title %}Logs - Super Admin Panel{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>üìù Tizim loglari</h2>
                <a href="{{ url_for('super_admin_dashboard') }}" class="btn btn-outline-primary">
                    ‚Üê Dashboard ga qaytish
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- So'nggi loglar -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">üìÑ So'nggi loglar</h5>
                </div>
                <div class="card-body">
                    <div class="log-container" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; max-height: 400px; overflow-y: auto; font-family: monospace; font-size: 12px;">
                        {% if logs.recent_logs %}
                            {% for log in logs.recent_logs %}
                                <div class="log-line mb-1">{{ log }}</div>
                            {% endfor %}
                        {% else %}
                            <p class="text-muted">Loglar mavjud emas</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Xatolar logi -->
        <div class="col-md-6 mb-4">
            <div class="card border-danger">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">üö® Xatolar logi</h5>
                </div>
                <div class="card-body">
                    <div class="log-container" style="background-color: #fff5f5; padding: 15px; border-radius: 5px; max-height: 400px; overflow-y: auto; font-family: monospace; font-size: 12px;">
                        {% if logs.error_logs %}
                            {% for error in logs.error_logs %}
                                <div class="log-line mb-1 text-danger">{{ error }}</div>
                            {% endfor %}
                        {% else %}
                            <p class="text-muted">Xatolar mavjud emas</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tizim loglari -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">üñ•Ô∏è Tizim loglari</h5>
                </div>
                <div class="card-body">
                    <div class="log-container" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 12px;">
                        {% if logs.system_logs %}
                            {% for log in logs.system_logs %}
                                <div class="log-line mb-1">{{ log }}</div>
                            {% endfor %}
                        {% else %}
                            <p class="text-muted">Tizim loglari mavjud emas</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Log statistikasi -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">üìä Log statistikasi</h5>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-md-4">
                            <div class="border p-3 rounded">
                                <h4 class="text-primary">{{ logs.recent_logs|length }}</h4>
                                <small class="text-muted">So'nggi loglar</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="border p-3 rounded">
                                <h4 class="text-danger">{{ logs.error_logs|length }}</h4>
                                <small class="text-muted">Xatolar soni</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="border p-3 rounded">
                                <h4 class="text-info">{{ logs.system_logs|length }}</h4>
                                <small class="text-muted">Tizim loglari</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.log-line {
    word-wrap: break-word;
    white-space: pre-wrap;
}
</style>
{% endblock %}
